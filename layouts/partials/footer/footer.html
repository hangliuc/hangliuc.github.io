<footer class="site-footer">
    <section class="copyright">
        &copy; 
        {{ if or (.Site.Params.footer.since) (.Site.Params.footer.customText) }}
            {{ if .Site.Params.footer.since }}
                {{ if lt .Site.Params.footer.since now.Year }}
                    {{ .Site.Params.footer.since }} - {{ now.Year }}
                {{ else }}
                    {{ now.Year }}
                {{ end }}
            {{ else }}
                {{ now.Year }}
            {{ end }}
        {{ else }}
            {{ now.Year }}
        {{ end }}
        {{ .Site.Title }}
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b>Stack</b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ğŸš€
    </section>
    
    <section style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
        <span>æ–‡ç« å‘å¸ƒ: <strong>{{ len .Site.RegularPages }}</strong> ç¯‡</span>
        &nbsp;|&nbsp;
        
        <span>æ–‡ç« æ€»è®¿é—®: <strong id="footer_total_views">...</strong> æ¬¡</span>
        
    </section>

    <section style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
        <span>ç½‘ç«™ç¨³å®šè¿è¡Œ: <strong id="footer_uptime">...</strong></span>
        &nbsp;|&nbsp;
        
        <span>ç½‘ç«™æ€»è®¿é—®é‡: <strong id="footer_total_site_visits">...</strong> æ¬¡</span>
    </section>

</footer>

<script>
(function() {
    function formatUptime(seconds) {
        const days = Math.floor(seconds / 86400);
        seconds %= 86400;

        const hours = Math.floor(seconds / 3600);
        seconds %= 3600;

        const minutes = Math.floor(seconds / 60);
        const secs = seconds % 60;

        return `${days} å¤© ${hours} å°æ—¶ ${minutes} åˆ† ${secs} ç§’`;
    }

    const isLocal = ["localhost", "127.0.0.1"].includes(window.location.hostname);
    
    const INFO_URL = isLocal 
        ? "http://localhost:8080/api/site/info"
        : "https://hangops.top/api/site/info";

    const VISIT_URL = isLocal 
        ? "http://localhost:8080/api/site/visit"
        : "https://hangops.top/api/site/visit";

    fetch(VISIT_URL, { method: 'POST' }).catch(() => {});

    // è·å–æ•°æ®å¹¶å±•ç¤º
    fetch(INFO_URL)
    .then(res => res.json())
    .then(data => {
        // æ›´æ–°æ–‡ç« è®¿é—®é‡
        if(data.total_views !== undefined) {
            document.getElementById("footer_total_views").innerText = data.total_views.toLocaleString();
        }
        // æ›´æ–°ç½‘ç«™è®¿é—®é‡
        if(data.site_total_visits !== undefined) {
            document.getElementById("footer_total_site_visits").innerText = data.site_total_visits.toLocaleString();
        }
                
        // æ›´æ–°è¿è¡Œæ—¶é—´
        if(data.uptime_seconds !== undefined) {
            let uptime = data.uptime_seconds;

            // ç«‹å³æ›´æ–°ä¸€æ¬¡
            document.getElementById("footer_uptime").innerText =
                formatUptime(uptime);

            // æ¯ç§’é€’å¢
            setInterval(() => {
                uptime++;
                document.getElementById("footer_uptime").innerText =
                    formatUptime(uptime);
            }, 1000);
        }
    })
    .catch(console.error);
})();
</script>

<div id="back-to-top" class="back-to-top" aria-label="å›åˆ°é¡¶éƒ¨">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M12 5l0 14"></path>
        <path d="M18 11l-6 -6"></path>
        <path d="M6 11l6 -6"></path>
    </svg>
</div>

<style>
    .back-to-top {
        position: fixed;
        bottom: 150px;
        right: 200px;
        width: 50px;
        height: 50px;
        background-color: var(--card-background); /* é€‚é…æ—¥/å¤œé—´æ¨¡å¼èƒŒæ™¯ */
        color: var(--card-text-color-main);       /* é€‚é…æ—¥/å¤œé—´æ¨¡å¼æ–‡å­— */
        box-shadow: var(--shadow-l1);             /* ä¸»é¢˜è‡ªå¸¦é˜´å½± */
        border-radius: 50%;                       /* åœ†å½¢æŒ‰é’® */
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;                               /* é»˜è®¤éšè— */
        visibility: hidden;
        transform: translateY(20px);              /* é»˜è®¤å‘ä¸‹åç§» */
        transition: all 0.3s ease;                /* å¹³æ»‘è¿‡æ¸¡åŠ¨ç”» */
        z-index: 999;
    }

    .back-to-top.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .back-to-top:hover {
        background-color: var(--primary);         /* æ‚¬åœå˜è‰² */
        color: #fff;
        transform: translateY(-3px);              /* æ‚¬åœè½»å¾®ä¸Šæµ® */
        box-shadow: var(--shadow-l2);
    }

    /* ç§»åŠ¨ç«¯è°ƒæ•´ä½ç½®ï¼Œé¿å…é®æŒ¡å†…å®¹ */
    @media (max-width: 768px) {
        .back-to-top {
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
        }
    }
</style>

<script>
(function() {
    const backToTopBtn = document.getElementById('back-to-top');
    
    // 1. ç›‘å¬æ»šåŠ¨ï¼Œæ§åˆ¶æŒ‰é’®æ˜¾ç¤º/éšè—
    window.addEventListener('scroll', () => {
        // å½“æ»šåŠ¨è¶…è¿‡ 300px æ—¶æ˜¾ç¤ºæŒ‰é’®
        if (window.scrollY > 300) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }
    });

    // 2. ç‚¹å‡»æŒ‰é’®ï¼Œå¹³æ»‘å›åˆ°é¡¶éƒ¨
    backToTopBtn.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
})();
</script>