<footer class="site-footer">
    <section class="copyright">
        &copy; 
        {{ if or (.Site.Params.footer.since) (.Site.Params.footer.customText) }}
            {{ if .Site.Params.footer.since }}
                {{ if lt .Site.Params.footer.since now.Year }}
                    {{ .Site.Params.footer.since }} - {{ now.Year }}
                {{ else }}
                    {{ now.Year }}
                {{ end }}
            {{ else }}
                {{ now.Year }}
            {{ end }}
        {{ else }}
            {{ now.Year }}
        {{ end }}
        {{ .Site.Title }}
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b>Stack</b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ğŸš€
    </section>
    
    <section style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
        <span>æ–‡ç« å‘å¸ƒ: <strong>{{ len .Site.RegularPages }}</strong> ç¯‡</span>
        &nbsp;|&nbsp;
        
        <span>æ–‡ç« æ€»è®¿é—®: <strong id="footer_total_views">...</strong> æ¬¡</span>
        
    </section>

    <section style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
        <span>ç½‘ç«™ç¨³å®šè¿è¡Œ: <strong id="footer_uptime">...</strong></span>
        &nbsp;|&nbsp;
        
        <span>ç½‘ç«™æ€»è®¿é—®é‡: <strong id="footer_total_site_visits">...</strong> æ¬¡</span>
    </section>

</footer>

<script>
(function() {
    function formatUptime(seconds) {
        const days = Math.floor(seconds / 86400);
        seconds %= 86400;

        const hours = Math.floor(seconds / 3600);
        seconds %= 3600;

        const minutes = Math.floor(seconds / 60);
        const secs = seconds % 60;

        return `${days} å¤© ${hours} å°æ—¶ ${minutes} åˆ† ${secs} ç§’`;
    }

    const isLocal = ["localhost", "127.0.0.1"].includes(window.location.hostname);
    
    const INFO_URL = isLocal 
        ? "http://localhost:8080/api/site/info"
        : "https://hangops.top/api/site/info";

    const VISIT_URL = isLocal 
        ? "http://localhost:8080/api/site/visit"
        : "https://hangops.top/api/site/visit";

    fetch(VISIT_URL, { method: 'POST' }).catch(() => {});

    // è·å–æ•°æ®å¹¶å±•ç¤º
    fetch(INFO_URL)
    .then(res => res.json())
    .then(data => {
        // æ›´æ–°æ–‡ç« è®¿é—®é‡
        if(data.total_views !== undefined) {
            document.getElementById("footer_total_views").innerText = data.total_views.toLocaleString();
        }
        // æ›´æ–°ç½‘ç«™è®¿é—®é‡
        if(data.site_total_visits !== undefined) {
            document.getElementById("footer_total_site_visits").innerText = data.site_total_visits.toLocaleString();
        }
                
        // æ›´æ–°è¿è¡Œæ—¶é—´
        if(data.uptime_seconds !== undefined) {
            let uptime = data.uptime_seconds;

            // ç«‹å³æ›´æ–°ä¸€æ¬¡
            document.getElementById("footer_uptime").innerText =
                formatUptime(uptime);

            // æ¯ç§’é€’å¢
            setInterval(() => {
                uptime++;
                document.getElementById("footer_uptime").innerText =
                    formatUptime(uptime);
            }, 1000);
        }
    })
    .catch(console.error);
})();
</script>